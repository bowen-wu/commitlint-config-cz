sudo: false

language: node_js

node_js:
    - 6
    - 8
    - 9
    - 10

matrix:
    fast_finish: true

cache:
    directories:
        - node_modules

before_install:
    - npm config set spin false
    - npm config set progress false
    - npm install -g npm@latest

install:
    - npm prune
    - npm update --no-save

script:
    - npm install . -g >/dev/null && npm uninstall . -g >/dev/null
    - mkdir -p "/tmp/${TRAVIS_REPO_SLUG}-test" && cd "/tmp/${TRAVIS_REPO_SLUG}-test" && npm init -y >/dev/null
    - npm install "$TRAVIS_BUILD_DIR" >/dev/null && npm uninstall "$TRAVIS_BUILD_DIR" >/dev/null
    - node -e "const config = require('${TRAVIS_REPO_SLUG##*/}');"
    - cd "$TRAVIS_BUILD_DIR"
    - npm run ci:test

after_success:
    - npm run ci:coveralls

deploy:
    - provider: npm
      email: npm@whizark.com
      api_key:
          secure: OlcXQs6B6Nz7OlDdyDrFh08Ola7wVmt8NbulAuDPfb4XMvyhDw+2fTwBpct4XI41tGVNOMvgDndtgiKG8NhVvMCl6G5dA4cVDE79RCKKmj2ja75fQO0wiW+OrXRhv3nOgLBDdp0k0jCTSqsgWscxYpKvOoOvwkx8ueN6IdCPx30LzAlbddZxUdhr3cWdHs9leSoaZDaf2y/iG/ayLhuxlGkwviMhaIZC5pvMEMEwHsoCYReaACAoyIdW0o5FS+YBCp/8YmnQM2l59pM6sJQFmN0dTeBu7dJ5o1zr3uqty7oENMkTbqNZbwva822s0vPq/fDASwsL7tSh1GLjPo4Jvp+k9gr22Joq/fEqb/q+5riHVIrIVcTfL1pCq8f0A0MlaB2RNiK8Kdi6pvgZ9QZa+PoQmZtFFytdsDqbh27iQVwjNIw/FMAh2INS/vLNdEcytfiFQrPOV0q/QW49bTSrMvpPxseP4CS+TcNnVkXCXSM7fc7hjRpUC+PwDI5SmfNq9vNjdajiiJ+z5QUK/1Y13dcCdJQZBjwRB/kdaXBbplFKMIPoq83Nusa24yUWEaumMtkOE1UblKwqAamsXKxmLHCKCt8eGL5U01gl6PEAFn1kNytEyGn0lGxozrk9V2N5wt7dFSqRE+Z4WE9YWpDsjgPypDE816TyuP7Z5Ms0xIk=
      on:
          node: 8
          repo: whizark/commitlint-config-cz
          branch: master
          tags: true

notifications:
    email: false

    slack:
        rooms:
            - secure: vOrkpUcbsyKeTBfVTBFOvRCJzhrsilT06aCD3TsMGI5Lj1C1ELvZrksbeqLnzF4WdN897WuiZaDbhD9ON3VTLNsqJ4Z+7MyIWAtNz36AMR5tuY/TO2R/wan93QpyAlHWnmPm6lEET/Xp3DnPwc5WlwV3N9yBHZXopt+JkBLQxecKm9Dja9ZeksHBPd2QTVmw82CJaCksVJW7T9Pkj/LRsV8Nl7gYdOD5uY4EH2EUdOlDNYME4tq4GtWkVuISst3Ca8rfnqlrGYVHk9Whi/bdLEO4MxEjuN1m61y+YgYMqmMRvErgR1VD/0p30VLRU1BLxxVzhQ+UhMGoXIvySrEc5nPYuqZ5kOUn8t8azLc585F64TNO8TjOnrblD82Eyewf/+Zn1o+Y7Hs1Jx9HjiIb66ALBI1efjBHwb7fQfjJwdiqHd+9ZtXwIvaoBeB1qZioSSLdn+Nio8VQAikaZMIMzuyOBH6SdPr98w6pJ6BQA3XVqE0zC/iaDzGqSj0xBaSQrLugx4jUDCExUpKhWMRNTp+Ny5FWw5n3EXHLFroB0brzkEx/dFPZo0UvlqH0RJVAUiLpb0imBbg/wr5bLxl/AjzMbIj5fZI3fg56Jvt31zvKMghNtvqgoPBDyI4Bhzba/90xN7Dl8sZ8jyd866Vxk2N9cjKG66pwwAdZKCJ8HKM=
        on_pull_requests: false
        on_start: never
        on_success: never
        on_failure: change
